/* concertina — Radix Accordion expand/collapse with scroll pinning support
 *
 * Add .concertina-content to your Accordion.Content elements.
 * The [data-switching] rules are managed automatically by useConcertina().
 */

.concertina-content {
  --concertina-open-duration: 200ms;
  --concertina-close-duration: 150ms;
  overflow: hidden;
}

.concertina-content[data-state="open"] {
  animation: concertina-open var(--concertina-open-duration) ease-out;
}

.concertina-content[data-state="closed"] {
  animation: concertina-close var(--concertina-close-duration) ease-out forwards;
}

@keyframes concertina-open {
  from {
    height: 0;
    opacity: 0;
  }
  to {
    height: var(--radix-accordion-content-height);
    opacity: 1;
  }
}

@keyframes concertina-close {
  from {
    height: var(--radix-accordion-content-height);
    opacity: 1;
  }
  to {
    height: 0;
    opacity: 0;
  }
}

/* When switching between items, run animations instantly so layout
   is in its final state for scroll pinning. Uses duration: 0s rather
   than animation: none to avoid re-triggering the close animation
   when data-switching is cleared after paint.
   data-switching is set by useConcertina(), cleared after paint. */
[data-switching] .concertina-content[data-state="closed"] {
  animation-duration: 0s;
}

[data-switching] .concertina-content[data-state="open"] {
  animation-duration: 0s;
}

/* StableSlot — all children overlap in the same grid cell.
   Grid auto-sizes to the largest child.
   Slots use flex-column so their content stretches to fill
   the reserved width — the visual footprint is constant. */
.concertina-stable-slot {
  display: grid;
}
.concertina-stable-slot > * {
  grid-area: 1 / 1;
  display: flex;
  flex-direction: column;
}

/* Inactive Slot hiding — belt and suspenders.
   Inline style sets visibility: hidden + opacity: 0 on the Slot div.
   CSS backup catches edge cases where inline styles are overridden.
   transition: none on descendants prevents children with transition-all
   from animating the inherited visibility change (CSS visibility is
   inherited; transition-all transitions it over the child's duration
   instead of hiding instantly). */
.concertina-stable-slot > [inert] {
  visibility: hidden;
  opacity: 0;
}
.concertina-stable-slot > [inert] * {
  transition: none;
}

/* Gigbag — size-reserving container.
   contain isolates internal reflow from ancestors. */
.concertina-gigbag {
  contain: layout style;
}

/* Warmup — structural placeholder shimmer grid. */
.concertina-warmup {
  display: grid;
  gap: var(--concertina-warmup-gap, 0.75rem);
  contain: layout style;
}

.concertina-warmup-bone {
  display: flex;
  flex-direction: column;
  gap: var(--concertina-warmup-bone-gap, 0.125rem);
  padding: var(--concertina-warmup-bone-padding, 0.375rem 0.5rem);
}

.concertina-warmup-line {
  height: 1lh;
  border-radius: var(--concertina-warmup-line-radius, 0.125rem);
  background: linear-gradient(
    90deg,
    var(--concertina-warmup-line-color, #e5e7eb) 25%,
    var(--concertina-warmup-line-highlight, #f3f4f6) 50%,
    var(--concertina-warmup-line-color, #e5e7eb) 75%
  );
  background-size: 200% 100%;
  animation: concertina-shimmer 1.5s ease-in-out infinite;
}


@keyframes concertina-shimmer {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}


/* Glide — enter/exit animation wrapper. */
.concertina-glide {
  --concertina-glide-duration: 200ms;
}

.concertina-glide-entering {
  animation: concertina-glide-in var(--concertina-glide-duration) ease-out;
}

.concertina-glide-exiting {
  animation: concertina-glide-out var(--concertina-glide-duration) ease-out forwards;
}

@keyframes concertina-glide-in {
  from { opacity: 0; max-height: 0; overflow: hidden; }
  to   { opacity: 1; max-height: var(--concertina-glide-height, 1000px); overflow: hidden; }
}

@keyframes concertina-glide-out {
  from { opacity: 1; max-height: var(--concertina-glide-height, 1000px); overflow: hidden; }
  to   { opacity: 0; max-height: 0; overflow: hidden; }
}

/* Warmup exit — fade out shimmer lines before content mounts.
   Applied by useWarmupExit() via className on the grid container. */
.concertina-warmup-exiting .concertina-warmup-line {
  animation: concertina-warmup-exit var(--concertina-close-duration, 150ms) ease-out forwards;
}

@keyframes concertina-warmup-exit {
  to { opacity: 0; }
}

/* Respect reduced-motion preferences.
   Disables all animations — accordion open/close, shimmer, and glide enter/exit.
   Layout changes still happen instantly so functionality is preserved. */
@media (prefers-reduced-motion: reduce) {
  .concertina-content[data-state="open"],
  .concertina-content[data-state="closed"],
  .concertina-glide-entering,
  .concertina-glide-exiting,
  .concertina-warmup-line,
  .concertina-warmup-exiting .concertina-warmup-line {
    animation-duration: 0s !important;
  }
}
